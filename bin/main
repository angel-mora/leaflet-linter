#!/usr/bin/env ruby
# frozen_string_literal: true

require 'colorize'
require 'colorized_string'

# Conditions

ERROR = [{ js: 'Layer out of layer.control in line' },
         { html: 'Content inside script detected.
            Add src to script tag and relocate code.
            Example: /js/script_relocated.js' }].freeze

WARNING = 'The file is bigger than 5mb. Compression suggested. Try https://mapshaper.org/'

# Test example

success_report = [{ files_inspected: 3 },
                  { total_offenses: 2 },
                  { path: 'index.html' },
                  { warning: 0 },
                  { error: 0 },
                  { offenses_details: nil }]

all_offenses_report = [{ files_inspected: 5 },
                       { total_offenses: 3 },
                       { path: 'index.html' },
                       { warning: 1 },
                       { error: 2 },
                       { offenses_details: nil }]

def final_report(report) # rubocop:disable Metrics/AbcSize
  if report[3][:warning].zero? && report[4][:error].zero?
    puts "Inspecting #{report[0][:files_inspected]} files"
    puts 'No offenses '.green + 'detected'
  elsif report[3][:warning].positive? || report[4][:error].positive?
    puts "Inspecting #{report[0][:files_inspected]} files"
    puts "#{report[1][:total_offenses]} offenses ".red + 'detected'
    # for later p offense_details.each
  elsif report[0][:files_inspected].zero?
    puts 'Please add some files'
  end
end

final_report(success_report)
final_report(all_offenses_report)
